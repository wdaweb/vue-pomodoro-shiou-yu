import{o as O,n as U,g as j,a as R,b as P,w as q,s as A,r as I,c as M,t as k,u as S,_ as F,d as W,e as L,f as x,h as l,i as d,j as K,k as B,l as y,m as v,F as _,p as H,q as J,V as C,v as Q}from"./index-CuE9uGbX.js";import{u as X}from"./list-CzYqL-mK.js";import{u as Y}from"./settings-By12V6rN.js";import{V as Z,a as V,b as ee}from"./VDivider-Da6zjouu.js";function G(e,t){return j()?(R(e,t),!0):!1}function b(){const e=new Set,t=i=>{e.delete(i)};return{on:i=>{e.add(i);const o=()=>t(i);return G(o),{off:o}},off:t,trigger:(...i)=>Promise.all(Array.from(e).map(o=>o(...i))),clear:()=>{e.clear()}}}const te=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const ne=Object.prototype.toString,ie=e=>ne.call(e)==="[object Object]";function E(e){return Array.isArray(e)?e:[e]}function oe(e){return P()}function se(e,t=!0,r){oe()?O(e,r):t?e():U(e)}function re(e,t,r){return q(e,t,{...r,immediate:!0})}const $=te?window:void 0;function ae(e){var t;const r=k(e);return(t=r?.$el)!==null&&t!==void 0?t:r}function le(...e){const t=(n,s,i,o)=>(n.addEventListener(s,i,o),()=>n.removeEventListener(s,i,o)),r=M(()=>{const n=E(k(e[0])).filter(s=>s!=null);return n.every(s=>typeof s!="string")?n:void 0});return re(()=>{var n,s;return[(n=(s=r.value)===null||s===void 0?void 0:s.map(i=>ae(i)))!==null&&n!==void 0?n:[$].filter(i=>i!=null),E(k(r.value?e[1]:e[0])),E(S(r.value?e[2]:e[1])),k(r.value?e[3]:e[2])]},([n,s,i,o],f,p)=>{if(!n?.length||!s?.length||!i?.length)return;const g=ie(o)?{...o}:o,h=n.flatMap(a=>s.flatMap(c=>i.map(m=>t(a,c,m,g))));p(()=>{h.forEach(a=>a())})},{flush:"post"})}function ce(){const e=A(!1),t=P();return t&&O(()=>{e.value=!0},t),e}function ue(e){const t=ce();return M(()=>(t.value,!!e()))}function de(e={}){const{window:t=$,requestPermissions:r=!0}=e,n=e,s=ue(()=>{if(!t||!("Notification"in t))return!1;if(Notification.permission==="granted")return!0;try{const u=new Notification("");u.onshow=()=>{u.close()}}catch(u){if(u.name==="TypeError")return!1}return!0}),i=A(s.value&&"permission"in Notification&&Notification.permission==="granted"),o=I(null),f=async()=>{if(s.value)return!i.value&&Notification.permission!=="denied"&&await Notification.requestPermission()==="granted"&&(i.value=!0),i.value},{on:p,trigger:g}=b(),{on:h,trigger:a}=b(),{on:c,trigger:m}=b(),{on:T,trigger:z}=b(),D=async u=>{if(!s.value||!i.value)return;const w=Object.assign({},n,u);return o.value=new Notification(w.title||"",w),o.value.onclick=g,o.value.onshow=a,o.value.onerror=m,o.value.onclose=z,o.value},N=()=>{o.value&&o.value.close(),o.value=null};if(r&&se(f),G(N),s.value&&t){const u=t.document;le(u,"visibilitychange",w=>{w.preventDefault(),u.visibilityState==="visible"&&N()})}return{isSupported:s,notification:o,ensurePermissions:f,permissionGranted:i,show:D,close:N,onClick:p,onShow:h,onError:c,onClose:T}}const fe={height:"523.213px",version:"1.1",viewBox:"0 0 289 523.213",width:"289px",x:"0px","xml:space":"preserve",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",y:"0px"},me={__name:"DigitNumber",props:["data","color"],setup(e){return W(t=>({v2d41a41b:e.color})),(t,r)=>(x(),L("svg",fe,[l("path",{id:"B",class:d({active:"045689".includes(e.data)}),d:"M20,249.873c0,5.523-4.477,10-10,10l0,0c-5.523,0-10-4.477-10-10v-218c0-5.523,4.477-10,10-10l0,0c5.523,0,10,4.477,10,10V249.873z"},null,2),l("path",{id:"C",class:d({active:"01234789".includes(e.data)}),d:"M289,249.873c0,5.523-4.477,10-10,10l0,0c-5.523,0-10-4.477-10-10v-218c0-5.523,4.477-10,10-10l0,0c5.523,0,10,4.477,10,10V249.873z"},null,2),l("path",{id:"A",class:d({active:"02356789".includes(e.data)}),d:"M255.082,1.873c5.522,0.048,9.961,4.563,9.914,10.086l0,0c-0.048,5.522-4.563,9.961-10.086,9.914L36.918,20c-5.522-0.048-9.961-4.563-9.914-10.086l0,0C27.052,4.392,31.567-0.047,37.09,0L255.082,1.873z"},null,2),l("path",{id:"D",class:d({active:"2345689".includes(e.data)}),d:"M255.082,250.81c5.522,0.048,9.961,4.563,9.914,10.086l0,0c-0.048,5.522-4.563,9.961-10.086,9.914l-217.992-1.873c-5.522-0.048-9.961-4.563-9.914-10.086l0,0c0.047-5.522,4.563-9.961,10.085-9.914L255.082,250.81z"},null,2),l("path",{id:"G",class:d({active:"0235689".includes(e.data)}),d:"M255.082,503.213c5.522,0.048,9.961,4.563,9.914,10.086l0,0c-0.048,5.522-4.563,9.961-10.086,9.914L36.918,521.34c-5.522-0.048-9.961-4.563-9.914-10.086l0,0c0.047-5.522,4.563-9.961,10.085-9.914L255.082,503.213z"},null,2),l("path",{id:"E",class:d({active:"0268".includes(e.data)}),d:"M20,498.818c0,5.523-4.477,10-10,10l0,0c-5.523,0-10-4.477-10-10v-218c0-5.523,4.477-10,10-10l0,0c5.523,0,10,4.477,10,10V498.818z"},null,2),l("path",{id:"F",class:d({active:"013456789".includes(e.data)}),d:"M289,498.818c0,5.523-4.477,10-10,10l0,0c-5.523,0-10-4.477-10-10v-218c0-5.523,4.477-10,10-10l0,0c5.523,0,10,4.477,10,10V498.818z"},null,2),l("circle",{class:d({active:e.data===":"}),cx:"146",cy:"126.873",r:"17"},null,2),l("circle",{class:d({active:e.data===":"}),cx:"146",cy:"389.818",r:"17"},null,2)]))}},ve=F(me,[["__scopeId","data-v-1bab3003"]]),pe=K("time",()=>{const e="1500",r=I(e),n=I(!1);return{timeleft:r,isBreakTime:n,TIME:e,TIME_BREAK:"300"}},{persist:{key:"pomodoro-time",pick:["timeleft","isBreakTime"]}}),we={__name:"HomeView",setup(e){const t=X(),r=Y(),n=pe(),s=M(()=>{const a=Math.floor(n.timeleft/60).toString().padStart(2,"0"),c=(n.timeleft%60).toString().padStart(2,"0");return a+":"+c}),i={STOP:0,COUNTING:1,PAUSE:2},o=I(i.STOP);let f=0;const p=()=>{o.value===i.STOP&&t.items.length>0&&t.currentItem===""&&(t.currentItem=n.isBreakTime?"休息":t.items.shift().text),o.value=i.COUNTING,f=setInterval(()=>{n.timeleft--,n.timeleft<0&&g()},1e3)},g=()=>{clearInterval(f),o.value=i.STOP;const a=new Audio;a.src=r.selectedAlarm.file,a.play();const{show:c,isSupported:m,permissionGranted:T}=de({title:"事項完成",body:t.currentItem,icon:new URL("@/assets/pomodoro-technique.png",import.meta.url).href});m.value&&T.value&&c(),n.isBreakTime||t.finishedItems.push({id:t.id++,text:t.currentItem}),t.currentItem="",t.items.length>0&&(n.isBreakTime=!n.isBreakTime),n.timeleft=n.isBreakTime?n.TIME_BREAK:n.TIME,t.items.length>0&&p()},h=()=>{clearInterval(f),o.value=i.PAUSE};return(a,c)=>(x(),B(Q,null,{default:y(()=>[v(Z,null,{default:y(()=>[v(V,{cols:"12"},{default:y(()=>[...c[0]||(c[0]=[l("h1",{class:"text-center"},"目前事項",-1)])]),_:1}),v(ee),v(V,{class:"text-center",cols:"12"},{default:y(()=>[(x(!0),L(_,null,H(s.value,(m,T)=>(x(),B(ve,{key:T,color:"white",data:m},null,8,["data"]))),128)),l("h2",null,J(S(t).currentItem||"沒有事項"),1),v(C,{disabled:o.value===i.COUNTING||S(t).currentItem.length===0&&S(t).items.length===0,icon:"mdi-play",onClick:p},null,8,["disabled"]),v(C,{disabled:o.value!==i.COUNTING,icon:"mdi-pause",onClick:h},null,8,["disabled"]),v(C,{disabled:S(t).currentItem.length===0,icon:"mdi-skip-next",onClick:g},null,8,["disabled"])]),_:1})]),_:1})]),_:1}))}};export{we as default};
